# 3-1 ステートメントとは
VBAではマクロを実行すると、記述されたコードの上から順番に命令が実行されていきます。その命令の一つひとつを**ステートメント**といいます。<br>
すべてのVBAプログラムは、1つ以上のステートメントで構成されており、完全にステートメントに分解することができます。
## 3-1-1 ステートメントの分類
|名称|説明|例|
|---|---|---|
|宣言ステートメント|変数、定数、プロシージャなどに名前をつけて定義する|Dim x As Long<br>Const X As Long = 10|
|代入ステートメント|辺スやプロパティに値を代入する|x = 10<br>Set wb = Workbooks.Add|
|実行可能ステートメント|何らかの動作を開始する|Debug.Print x<br>Workbooks.Add|
## 3-2-2 ステートメントの記述
- ステートメント
    ~~~
    Sub MySub() -①
        Dim i As Long -②
        For i = 1 To 10 -③
            Debug.Print i -④
        Next i -③
    End Sub -①
    ~~~
    > 1~4のステートメントに分解することができる
- 変数の宣言と代入を1行に記述
    - 1行に複数のステートメントを記述することで可読性を高めることができる
        ~~~
        Dim message As String: message = "Hoge"
        ~~~
        ~~~
        For i = 1 To 10:Debug.Print i: Next i
        ~~~
    - 半角スペースとアンダースコアを組み合わせ(_)を仕様すると、ステートメントの途中で改行を加えることができる。これを**行連結文字**という。
        ~~~
        x = WorksheetFunction.SumIfs( _
            ws.Range("F:F"), _
            ws.Range("B:B"), ws.Cells(i, 2).Value, _
            ws.Range("C:C"), ws.Cells(i, 3).Value _
        )
        ~~~
        > コード行が長くなった場合に、可読性を高めるテクニックとして有効
## 3-1-3 構文の表記規則
|表記例|説明|
|---|---|
|**Sub、If、Debug、Print、True**|太字で先頭が大文字の単語は、VBA固有のキーワードを表す|
|**0、1**|そのとおりに入力すべき単語は、太字で表す|
|*object、varname、arglist*|斜体の単語は、ユーザーが何らかの情報を入力する箇所を表す|
|[expressionlist]|角かっこ([])内の項目は省略可能であることを表す|
|{While\|Until}|波かっこ({})内のパイプ記号(\|)で区切られたいずれかを選択して記述することを表す|
|[Public\|Private]|角かっこ([])何のパイプ記号(\|)で区切られたいずれかを選択するか、もしくは両方共省略可能であることを表す|
# 3-2 スコープの種類
## 3-2-1 スコープの種類
|スコープ|説明|
|---|---|
|プロシージャレベル|宣言されたプロシージャ内でのみ使用できる|
|プライベートモジュールレベル|宣言されたモジュール内でのみ使用できる|
|パブリックモジュールレベル|宣言されたモジュール以外の他のモジュールから使用できる|
- 宣言の対象と指定できるスコープ
    |宣言する対象|プロシージャレベル|プライベートモジュールレベル|パブリックモジュールレベル|
    |---|---|---|---|
    |変数|〇|〇|〇|
    |定数|〇|〇|〇|
    |列挙型||〇|〇|
    |プロシージャ||〇|〇|
## 3-2-2 宣言セクション
~~~
Option Explicit

Private x As String 'プライベートモジュールレベル
~~~
> モジュールの先頭のプロシージャよりも上の領域のこと
## 3-2-3 プロシージャレベル
- プロシージャレベルの変数
    ~~~
    Sub MySub_Module1()
        Dim X As String 'プロシージャレベル
        x = "使用可能です"
        Debug.Print x
    End Sub
    ~~~
    ~~~
    Sub MySub2_Module1()
        x = "使用可能です" '※コンパイルエラー
        Debug.Print x
    End Sub
    ~~~
    ~~~
    Sub MySub_Module2()
        x = "使用可能です" '※コンパイルエラー
        Debug.Print x
    End Sub
    ~~~
    ## 3-2-4 プライベートモジュールレベル
    